# can handle all of these like narcs because a028 is built unconditionally

HIDDEN_ABILITY_TABLE_TARGET := $(BUILD)/a028/9_07
HIDDEN_ABILITY_TABLE_DEPENDENCIES := data/HiddenAbilityTable.c
HIDDEN_ABILITY_TABLE_OBJS := $(patsubst data/%.c,build/%.o,$(HIDDEN_ABILITY_TABLE_DEPENDENCIES))
HIDDEN_ABILITY_TABLE_BIN := $(patsubst data/%.c,build/%.bin,$(HIDDEN_ABILITY_TABLE_DEPENDENCIES))

$(HIDDEN_ABILITY_TABLE_BIN): $(HIDDEN_ABILITY_TABLE_DEPENDENCIES)
	$(CC) $(CFLAGS) -c $< -o $(HIDDEN_ABILITY_TABLE_OBJS)
	$(OBJCOPY) -O binary $(HIDDEN_ABILITY_TABLE_OBJS) $@

NARC_FILES += $(HIDDEN_ABILITY_TABLE_BIN)

BASE_EXPERIENCE_TABLE_TARGET := $(BUILD)/a028/9_08
BASE_EXPERIENCE_TABLE_DEPENDENCIES := data/BaseExperienceTable.c
BASE_EXPERIENCE_TABLE_OBJS := $(patsubst data/%.c,build/%.o,$(BASE_EXPERIENCE_TABLE_DEPENDENCIES))
BASE_EXPERIENCE_TABLE_BIN := $(patsubst data/%.c,build/%.bin,$(BASE_EXPERIENCE_TABLE_DEPENDENCIES))

$(BASE_EXPERIENCE_TABLE_BIN): $(BASE_EXPERIENCE_TABLE_DEPENDENCIES)
	$(CC) $(CFLAGS) -c $< -o $(BASE_EXPERIENCE_TABLE_OBJS)
	$(OBJCOPY) -O binary $(BASE_EXPERIENCE_TABLE_OBJS) $@

NARC_FILES += $(BASE_EXPERIENCE_TABLE_BIN)

SPECIES_TO_OW_GFX_TARGET := $(BUILD)/a028/9_10
SPECIES_TO_OW_GFX_DEPENDENCIES := data/SpeciesToOWGfx.c
SPECIES_TO_OW_GFX_OBJS := $(patsubst data/%.c,build/%.o,$(SPECIES_TO_OW_GFX_DEPENDENCIES))
SPECIES_TO_OW_GFX_BIN := $(patsubst data/%.c,build/%.bin,$(SPECIES_TO_OW_GFX_DEPENDENCIES))

$(SPECIES_TO_OW_GFX_BIN): $(SPECIES_TO_OW_GFX_DEPENDENCIES)
	$(CC) $(CFLAGS) -c $< -o $(SPECIES_TO_OW_GFX_OBJS)
	$(OBJCOPY) -O binary $(SPECIES_TO_OW_GFX_OBJS) $@

NARC_FILES += $(SPECIES_TO_OW_GFX_BIN)


POKEFORMDATATBL_TARGET := $(BUILD)/a028/9_11
POKEFORMDATATBL_DEPENDENCIES := data/PokeFormDataTbl.c
POKEFORMDATATBL_OBJS := $(patsubst data/%.c,build/%.o,$(POKEFORMDATATBL_DEPENDENCIES))
POKEFORMDATATBL_BIN := $(patsubst data/%.c,build/%.bin,$(POKEFORMDATATBL_DEPENDENCIES))

$(POKEFORMDATATBL_BIN): $(POKEFORMDATATBL_DEPENDENCIES)
	$(CC) $(CFLAGS) -c $< -o $(POKEFORMDATATBL_OBJS)
	$(OBJCOPY) -O binary $(POKEFORMDATATBL_OBJS) $@

NARC_FILES += $(POKEFORMDATATBL_BIN)


FORMTOSPECIES_TARGET := $(BUILD)/a028/9_12
FORMTOSPECIES_DEPENDENCIES := data/FormToSpeciesMapping.c
FORMTOSPECIES_OBJS := $(patsubst data/%.c,build/%.o,$(FORMTOSPECIES_DEPENDENCIES))
FORMTOSPECIES_BIN := $(patsubst data/%.c,build/%.bin,$(FORMTOSPECIES_DEPENDENCIES))

$(FORMTOSPECIES_BIN): $(FORMTOSPECIES_DEPENDENCIES)
	$(CC) $(CFLAGS) -c $< -o $(FORMTOSPECIES_OBJS)
	$(OBJCOPY) -O binary $(FORMTOSPECIES_OBJS) $@

NARC_FILES += $(FORMTOSPECIES_BIN)


FORMREVERSION_TARGET := $(BUILD)/a028/9_13
FORMREVERSION_DEPENDENCIES := data/FormReversionMapping.c
FORMREVERSION_OBJS := $(patsubst data/%.c,build/%.o,$(FORMREVERSION_DEPENDENCIES))
FORMREVERSION_BIN := $(patsubst data/%.c,build/%.bin,$(FORMREVERSION_DEPENDENCIES))

$(FORMREVERSION_BIN): $(FORMREVERSION_DEPENDENCIES)
	$(CC) $(CFLAGS) -c $< -o $(FORMREVERSION_OBJS)
	$(OBJCOPY) -O binary $(FORMREVERSION_OBJS) $@

NARC_FILES += $(FORMREVERSION_BIN)


LEARNSETS_INPUT = data/learnsets/learnsets.json
LEARNSET_OUTPUT_DIR := build/learnset
LEARNSETS_HEADER := $(INCLUDE_SUBDIR)/constants/generated/learnsets.h
MACHINELEARNSET_DEPENDENCIES := $(LEARNSET_OUTPUT_DIR)/MachineMoveLearnsets.c
TUTORLEARNSET_DEPENDENCIES := $(LEARNSET_OUTPUT_DIR)/TutorMoveLearnsets.c
LEVELUPLEARNSET_DEPENDENCIES := $(LEARNSET_OUTPUT_DIR)/LevelupLearnsets.c
EGGLEARNSET_DEPENDENCIES := $(LEARNSET_OUTPUT_DIR)/EggLearnsets.c

$(LEARNSETS_HEADER): $(LEARNSETS_INPUT) $(VENV_ACTIVATE)
	@echo "generating learnset data..."
	$(PYTHON) scripts/build_learnsets.py \
		--learnsets $(LEARNSETS_INPUT) \
		--machineout $(MACHINELEARNSET_DEPENDENCIES) \
		--levelupout $(LEVELUPLEARNSET_DEPENDENCIES) \
		--eggout $(EGGLEARNSET_DEPENDENCIES) \
		--tutorout $(TUTORLEARNSET_DEPENDENCIES) \
		--constsout

MACHINELEARNSET_TARGET := $(BUILD)/a028/9_14
MACHINELEARNSET_OBJS := $(patsubst %.c,%.o,$(MACHINELEARNSET_DEPENDENCIES))
MACHINELEARNSET_BIN := $(patsubst $(LEARNSET_OUTPUT_DIR)/%.c,$(BUILD)/%.bin,$(MACHINELEARNSET_DEPENDENCIES))
$(MACHINELEARNSET_DEPENDENCIES): $(LEARNSETS_HEADER)

$(MACHINELEARNSET_BIN): $(LEARNSETS_HEADER)
	@echo "writing machine learnsets..."
	$(CC) $(CFLAGS) -c $(MACHINELEARNSET_DEPENDENCIES) -o $(MACHINELEARNSET_OBJS)
	$(OBJCOPY) -O binary $(MACHINELEARNSET_OBJS) $@

NARC_FILES += $(MACHINELEARNSET_BIN)


TUTORLEARNSET_TARGET := $(BUILD)/a028/9_15
TUTORLEARNSET_OBJS := $(patsubst %.c,%.o,$(TUTORLEARNSET_DEPENDENCIES))
TUTORLEARNSET_BIN := $(patsubst $(LEARNSET_OUTPUT_DIR)/%.c,$(BUILD)/%.bin,$(TUTORLEARNSET_DEPENDENCIES))
$(TUTORLEARNSET_DEPENDENCIES): $(LEARNSETS_HEADER)

$(TUTORLEARNSET_BIN): $(LEARNSETS_HEADER)
	@echo "writing tutor learnsets..."
	$(CC) $(CFLAGS) -c $(TUTORLEARNSET_DEPENDENCIES) -o $(TUTORLEARNSET_OBJS)
	$(OBJCOPY) -O binary $(TUTORLEARNSET_OBJS) $@

NARC_FILES += $(TUTORLEARNSET_BIN)


LEVELUPLEARNSET_TARGET := $(FILESYS)/a/0/3/3
LEVELUPLEARNSET_NARC := $(BUILD_NARC)/a033.narc
LEVELUPLEARNSET_OBJS := $(patsubst %.c,%.o,$(LEVELUPLEARNSET_DEPENDENCIES))
LEVELUPLEARNSET_BIN := $(patsubst $(LEARNSET_OUTPUT_DIR)/%.c,$(BUILD)/a033/%.bin,$(LEVELUPLEARNSET_DEPENDENCIES))
$(LEVELUPLEARNSET_DEPENDENCIES): $(LEARNSETS_HEADER)

$(LEVELUPLEARNSET_NARC): $(LEARNSETS_HEADER)
	@echo "writing levelup moves..."
	$(CC) $(CFLAGS) -c $(LEVELUPLEARNSET_DEPENDENCIES) -o $(LEVELUPLEARNSET_OBJS)
	$(OBJCOPY) -O binary $(LEVELUPLEARNSET_OBJS) $(LEVELUPLEARNSET_BIN)
	$(NARCHIVE) create $@ $(BUILD)/a033/ -nf

NARC_FILES += $(LEVELUPLEARNSET_NARC)
REQUIRED_DIRECTORIES += $(BUILD)/a033

EGGLEARNSET_TARGET := $(FILESYS)/a/2/2/9
EGGLEARNSET_NARC := $(BUILD_NARC)/a229.narc
EGGLEARNSET_OBJS := $(patsubst %.c,%.o,$(EGGLEARNSET_DEPENDENCIES))
EGGLEARNSET_BIN := $(patsubst $(LEARNSET_OUTPUT_DIR)/%.c,$(BUILD)/a229/%.bin,$(EGGLEARNSET_DEPENDENCIES))
$(EGGLEARNSET_DEPENDENCIES): $(LEARNSETS_HEADER)

$(EGGLEARNSET_NARC): $(LEARNSETS_HEADER)
	@echo "writing egg learnsets..."
	$(CC) $(CFLAGS) -c $(EGGLEARNSET_DEPENDENCIES) -o $(EGGLEARNSET_OBJS)
	$(OBJCOPY) -O binary $(EGGLEARNSET_OBJS) $@
	$(NARCHIVE) create $@ $(BUILD)/a229/ -nf

NARC_FILES += $(EGGLEARNSET_NARC)
REQUIRED_DIRECTORIES += $(BUILD)/a229 $(LEARNSET_OUTPUT_DIR)

